## 1. 지식 영역 정의

### 핵심 주제
- **일반 지식**: 기본적인 사실, 개념, 정의를 포함하는 범용 지식
- **도메인별 전문 지식**: 데이터 분석, 심리학, 기술, 비즈니스 등 특정 분야 지식
- **시간 의존적 지식**: 최신 이벤트, 트렌드, 기술 발전 등 시간에 따라 변화하는 정보
- **방법론적 지식**: 데이터 분석 방법, 보고서 작성 기법, 문제 해결 프레임워크
- **메타데이터**: 정보의 출처, 신뢰성, 최종 업데이트 시간 등에 관한 정보

### 개념 계층
```
지식 베이스
├── 사실 기반 지식
│   ├── 정적 지식 (불변 사실, 역사적 정보)
│   └── 동적 지식 (변화하는 사실, 최신 정보)
├── 도메인 지식
│   ├── 데이터 과학
│   │   ├── 통계 분석 방법론
│   │   ├── 머신러닝 알고리즘
│   │   └── 데이터 시각화 기법
│   ├── 심리학
│   │   ├── 감정 분석 모델
│   │   ├── 행동 패턴 이론
│   │   └── 공감 커뮤니케이션 기법
│   └── 기타 전문 영역
├── 방법론 지식
│   ├── 문제 해결 프레임워크
│   ├── 보고서 구성 템플릿
│   └── 데이터 분석 워크플로
└── 참조 정보
    ├── 용어 사전
    ├── 분류 체계
    └── 메타데이터 스키마
```

### 필수 용어집
- **벡터 임베딩**: 텍스트나 데이터를 수치 벡터로 변환한 표현
- **청킹**: 긴 텍스트를 의미 있는 작은 단위로 분할하는 과정
- **관련성 점수**: 쿼리와 검색된 정보 간의 유사성 측정값
- **메타데이터**: 정보에 대한 정보(출처, 시간, 신뢰도 등)
- **시맨틱 검색**: 의미 기반 정보 검색 방식
- **지식 그래프**: 개체와 관계의 네트워크로 표현된 지식 구조
- **온톨로지**: 도메인 내 개념과 관계에 대한 형식적 명세
- **컨텍스트 윈도우**: LLM이 처리할 수 있는 입력 토큰의 최대 범위

## 2. 데이터 소스

### 내부 소스
- **기본 지식 코퍼스**: 
  - 시스템에 사전 로드된 일반 지식 및 도메인 지식
  - 구조화된 참조 자료(사전, 용어집, 가이드라인)
  - 방법론 및 프레임워크 문서

- **사용자 제공 데이터**:
  - 업로드된 문서, 보고서, 데이터셋
  - 사용자 쿼리 및 피드백 이력
  - 커스텀 지식 베이스 및 메모

- **생성된 분석 결과**:
  - 이전 분석 보고서 및 인사이트
  - 데이터 분석 결과 및 시각화
  - 에이전트 생성 콘텐츠의 아카이브

### 외부 소스
- **웹 기반 소스**:
  - 검색 엔진 API (Google, Bing 등)
  - 전문 데이터베이스 및 학술 검색 (PubMed, ArXiv 등)
  - 뉴스 API 및 RSS 피드

- **공개 데이터셋**:
  - 공공 데이터 포털 (Data.gov, Kaggle 등)
  - 오픈 소스 데이터 리포지토리
  - 통계 데이터베이스 (OECD, World Bank 등)

- **API 통합**:
  - 외부 지식 API (Wikipedia, Wikidata 등)
  - 산업 및 금융 데이터 API
  - 소셜 미디어 API 및 트렌드 분석 도구

### 업데이트 주기
- **실시간 업데이트**:
  - 웹 검색 결과 (쿼리 시점에 최신 정보 검색)
  - 사용자 제공 데이터 (업로드 즉시 처리)
  - 시스템 생성 분석 결과 (생성 즉시 저장)

- **정기 업데이트**:
  - 일반 지식 코퍼스 (월간 업데이트)
  - 공개 데이터셋 (소스 갱신 시 업데이트)
  - 도메인 전문 지식 (분기별 업데이트)

- **온디맨드 업데이트**:
  - 사용자 요청에 따른 특정 주제 지식 확장
  - 트렌드 모니터링 결과에 따른 선택적 업데이트
  - 시스템 성능 분석 기반 지식 갭 보완

## 3. 지식 저장소 설계

### 벡터 DB 구조
- **주요 컬렉션**:
  - `general_knowledge`: 일반적인 사실 및 개념
  - `domain_knowledge`: 도메인별 전문 지식
  - `user_data`: 사용자 제공 데이터 및 분석
  - `generated_content`: 시스템 생성 결과물

- **임베딩 방식**:
  - 모델: 도메인에 따라 적절한 임베딩 모델 선택
    - 일반 지식: OpenAI Ada/text-embedding-ada-002
    - 전문 지식: 도메인 특화 임베딩 모델
  - 차원: 1536 차원(기본) / 도메인별 최적화 차원
  - 정규화: L2 정규화 적용

- **인덱스 구조**:
  - HNSW(Hierarchical Navigable Small World) 인덱스
  - IVF(Inverted File Index)와 PQ(Product Quantization) 조합
  - 메타데이터 기반 필터링 지원

### 청킹 전략
- **텍스트 청킹 방식**:
  - 기본 단위: 의미 기반 청킹 (단락, 섹션)
  - 크기 범위: 256-512 토큰 (최적 검색 크기)
  - 중첩 정도: 50-100 토큰 (컨텍스트 연속성 보장)

- **문서 유형별 특화 전략**:
  - 학술 논문: 초록, 방법론, 결과, 논의 섹션 별도 청킹
  - 보고서: 요약, 주요 발견, 권장사항 별도 청킹
  - 데이터셋: 메타데이터, 스키마, 주요 통계 별도 청킹

- **계층적 청킹**:
  - L1: 문서 전체 (고수준 개요)
  - L2: 주요 섹션 (중간 수준 컨텍스트)
  - L3: 세부 단락 (상세 정보)

### 메타데이터 스키마
```json
{
  "document_id": "unique_identifier",
  "chunk_id": "chunk_identifier",
  "title": "document title",
  "source": {
    "type": "web|internal|user|generated",
    "url": "source_url_if_applicable",
    "author": "content_creator",
    "publisher": "publishing_entity"
  },
  "temporal": {
    "created_at": "creation_timestamp",
    "updated_at": "last_update_timestamp",
    "valid_until": "expiration_date_if_applicable",
    "temporal_relevance": "static|current|historical"
  },
  "content_type": "text|code|data|mixed",
  "domain": ["primary_domain", "secondary_domain"],
  "language": "content_language",
  "quality": {
    "reliability_score": 0.95,
    "verification_status": "verified|unverified|disputed",
    "verification_method": "method_of_verification"
  },
  "relationships": {
    "parent_id": "parent_document_id",
    "related_ids": ["related_document_ids"],
    "follows": "previous_chunk_id",
    "precedes": "next_chunk_id"
  },
  "usage_stats": {
    "retrieval_count": 42,
    "relevance_feedback": 0.87,
    "last_accessed": "last_access_timestamp"
  }
}
```

## 4. 지식 접근 패턴

### 검색 방법
- **하이브리드 검색**:
  - 시맨틱 검색: 벡터 유사도 기반 관련성 검색
  - 키워드 검색: 정확한 용어 및 개념 매칭
  - 필터 검색: 메타데이터 기반 결과 필터링
  - 조합 방식: BM25 + 벡터 검색 하이브리드 점수

- **다단계 검색 프로세스**:
  1. 쿼리 분석 및 확장: 핵심 의도 파악, 관련 키워드 식별
  2. 초기 후보군 검색: 광범위한 관련 문서 식별
  3. 재순위화: 정밀 관련성 평가 및 순위 조정
  4. 결과 다양화: 다양한 관점 및 소스 포함 보장

- **멀티 인덱스 쿼리**:
  - 여러 컬렉션 동시 검색
  - 도메인 가중치 조정
  - 결과 통합 및 중복 제거

### 관련성 평가
- **유사도 메트릭**:
  - 코사인 유사도: 기본 벡터 유사도 측정
  - 맥락적 관련성: LLM 기반 심층 관련성 평가
  - 시간적 관련성: 정보의 최신성 가중치

- **다차원 관련성 스코어**:
  ```
  총점 = α(의미적 유사도) + β(시간적 관련성) + γ(신뢰도) + δ(깊이) - ε(중복성)
  ```
  - α, β, γ, δ, ε: 쿼리 유형 및 컨텍스트에 따라 동적 조정되는 가중치

- **피드백 기반 개선**:
  - 명시적 피드백: 사용자 평가 및 선택
  - 암묵적 피드백: 사용 패턴 및 상호작용 분석
  - 지속적 학습: 검색 성능 최적화를 위한 파라미터 조정

### 컨텍스트 관리
- **대화 컨텍스트 통합**:
  - 이전 대화 이력 분석 및 현재 쿼리 컨텍스트화
  - 사용자 관심사 및 의도 프로파일링
  - 점진적 쿼리 구체화 및 확장

- **RAG 파이프라인**:
  - 준비 단계: 쿼리 이해 및 재구성
  - 검색 단계: 관련 정보 추출
  - 증강 단계: 검색 결과로 LLM 컨텍스트 증강
  - 생성 단계: 증강된 지식 기반 응답 생성

- **규모 확장성 전략**:
  - 계층적 검색: 넓은 검색 → 심층 검색
  - 선택적 로딩: 관련성에 따른 컨텍스트 우선순위화
  - 동적 컨텍스트 윈도우: 유동적 컨텍스트 길이 조정

- **멀티 에이전트 지식 교환**:
  - 에이전트별 특화 지식 접근 패턴
  - 공유 컨텍스트 풀 유지
  - 지식 전파 프로토콜 정의

이 지식 베이스 설계는 멀티 에이전트 시스템이 다양한 정보를 효율적으로 저장하고 접근할 수 있는 구조를 제공합니다. 벡터 DB 기반의 시맨틱 검색, 지능적인 청킹 전략, 풍부한 메타데이터, 그리고 컨텍스트 인식 검색 메커니즘을 통해 RAG 에이전트와 웹 검색 에이전트가 정보를 효과적으로 검색하고 활용할 수 있도록 설계되었습니다. 이 구조는 데이터 분석 에이전트, 심리분석 에이전트, 보고서 작성 에이전트의 작업을 위한 지식 기반도 제공합니다.